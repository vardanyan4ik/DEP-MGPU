Задание 1: Создать представление по скидкам

Задача: Агрегировать данные о скидках по категориям товаров

Логика:

JOIN между stg.orders и dw.product_dim по product_id

Группировка по category

Расчет средней скидки в % и общей суммы предоставленных скидок

Создание VIEW для повторного использования

Задание 2: Определить количество товаров по категориям

Задача: Посчитать общее количество проданных товаров в разрезе категорий

Логика:

Простая агрегация из stg.orders

Группировка по category

SUM(quantity) для получения общего количества

Задание 3: Рассчитать прибыль по менеджерам

Задача: Проанализировать эффективность работы менеджеров по регионам

Логика:

JOIN stg.orders с people по region (менеджер закреплен за регионом)

Группировка по person (менеджеру)

Расчет общей прибыли, средней прибыли на заказ и количества заказов

Сортировка по убыванию прибыли для выявления лучших менеджеров